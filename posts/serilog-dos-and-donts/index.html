<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><title>Serilog Do's and Don'ts | ESG's</title><meta name=viewport content="width=device-width,minimum-scale=1"><meta name=description content="Some tips on how to effectively use structure logging using Serilog"><meta name=generator content="Hugo 0.101.0"><meta name=robots content="index, follow"><link rel=stylesheet href=/ananke/css/main.min.92512b2fc2f1e243e72db3ba73bf5d83449c5dbd84320e5759a128ff79ecf623.css><meta property="og:title" content="Serilog Do's and Don'ts"><meta property="og:description" content="Some tips on how to effectively use structure logging using Serilog"><meta property="og:type" content="article"><meta property="og:url" content="https://esg.dev/posts/serilog-dos-and-donts/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2020-07-12T18:08:20-04:00"><meta property="article:modified_time" content="2021-03-01T13:30:00-05:00"><meta itemprop=name content="Serilog Do's and Don'ts"><meta itemprop=description content="Some tips on how to effectively use structure logging using Serilog"><meta itemprop=datePublished content="2020-07-12T18:08:20-04:00"><meta itemprop=dateModified content="2021-03-01T13:30:00-05:00"><meta itemprop=wordCount content="1018"><meta itemprop=keywords content="Serilog,.NET,"><meta name=twitter:card content="summary"><meta name=twitter:title content="Serilog Do's and Don'ts"><meta name=twitter:description content="Some tips on how to effectively use structure logging using Serilog"><script async src="https://www.googletagmanager.com/gtag/js?id=UA-145113644-1"></script>
<script>var dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes";if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","UA-145113644-1",{anonymize_ip:!0})}</script><script defer src=https://static.cloudflareinsights.com/beacon.min.js data-cf-beacon='{"token": "f3ac8a79d2374409967afcd84adea76e"}'></script></head><body class="ma0 avenir bg-near-white production"><header><div class=bg-black><nav class="pv3 ph3 ph4-ns" role=navigation><div class="flex-l justify-between items-center center"><a href=/ class="f3 fw2 hover-white no-underline white-90 dib">ESG's</a><div class="flex-l items-center"><ul class="pl0 mr3"><li class="list f5 f4-ns fw4 dib pr3"><a class="hover-white no-underline white-90" href=/about/ title="About page">About</a></li><li class="list f5 f4-ns fw4 dib pr3"><a class="hover-white no-underline white-90" href=/posts/ title="Posts page">Posts</a></li><li class="list f5 f4-ns fw4 dib pr3"><a class="hover-white no-underline white-90" href=/tags/ title="Tags page">Tags</a></li></ul><div class=ananke-socials><a href=https://twitter.com/Eric_STG target=_blank class="twitter ananke-social-link link-transition stackoverflow link dib z-999 pt3 pt0-l mr1" title="Twitter link" rel=noopener aria-label="follow on Twitter——Opens in a new window"><span class=icon><svg style="enable-background:new 0 0 67 67" viewBox="0 0 67 67" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M37.167 22.283c-2.619.953-4.274 3.411-4.086 6.101l.063 1.038-1.048-.127c-3.813-.487-7.145-2.139-9.974-4.915l-1.383-1.377-.356 1.017c-.754 2.267-.272 4.661 1.299 6.271.838.89.649 1.017-.796.487-.503-.169-.943-.296-.985-.233-.146.149.356 2.076.754 2.839.545 1.06 1.655 2.097 2.871 2.712l1.027.487-1.215.021c-1.173.0-1.215.021-1.089.467.419 1.377 2.074 2.839 3.918 3.475l1.299.444-1.131.678c-1.676.976-3.646 1.526-5.616 1.568C19.775 43.256 19 43.341 19 43.405c0 .211 2.557 1.397 4.044 1.864 4.463 1.377 9.765.783 13.746-1.568 2.829-1.673 5.657-5 6.978-8.221.713-1.716 1.425-4.851 1.425-6.354.0-.975.063-1.102 1.236-2.267.692-.678 1.341-1.419 1.467-1.631.21-.403.188-.403-.88-.043-1.781.636-2.033.551-1.152-.402.649-.678 1.425-1.907 1.425-2.267.0-.063-.314.042-.671.233-.377.212-1.215.53-1.844.72l-1.131.361-1.027-.7c-.566-.381-1.361-.805-1.781-.932C39.766 21.902 38.131 21.944 37.167 22.283zM33 64C16.432 64 3 50.569 3 34S16.432 4 33 4s30 13.431 30 30S49.568 64 33 64z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg></span><span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg></span></a><a href=https://github.com/EricStG target=_blank class="github ananke-social-link link-transition stackoverflow link dib z-999 pt3 pt0-l mr1" title="GitHub link" rel=noopener aria-label="follow on GitHub——Opens in a new window"><span class=icon><svg style="enable-background:new 0 0 512 512" viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M256 32C132.3 32 32 134.8 32 261.7c0 101.5 64.2 187.5 153.2 217.9 11.2 2.1 15.3-5 15.3-11.1.0-5.5-.2-19.9-.3-39.1-62.3 13.9-75.5-30.8-75.5-30.8-10.2-26.5-24.9-33.6-24.9-33.6-20.3-14.3 1.5-14 1.5-14 22.5 1.6 34.3 23.7 34.3 23.7 20 35.1 52.4 25 65.2 19.1 2-14.8 7.8-25 14.2-30.7-49.7-5.8-102-25.5-102-113.5.0-25.1 8.7-45.6 23-61.6-2.3-5.8-10-29.2 2.2-60.8.0.0 18.8-6.2 61.6 23.5 17.9-5.1 37-7.6 56.1-7.7 19 .1 38.2 2.6 56.1 7.7 42.8-29.7 61.5-23.5 61.5-23.5 12.2 31.6 4.5 55 2.2 60.8 14.3 16.1 23 36.6 23 61.6.0 88.2-52.4 107.6-102.3 113.3 8 7.1 15.2 21.1 15.2 42.5.0 30.7-.3 55.5-.3 63 0 6.1 4 13.3 15.4 11C415.9 449.1 480 363.1 480 261.7 480 134.8 379.7 32 256 32z"/></svg></span><span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg></span></a><a href=https://www.linkedin.com/in/eric-st-georges/ target=_blank class="linkedin ananke-social-link link-transition stackoverflow link dib z-999 pt3 pt0-l mr1" title="LinkedIn link" rel=noopener aria-label="follow on LinkedIn——Opens in a new window"><span class=icon><svg style="enable-background:new 0 0 65 65" viewBox="0 0 65 65" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M50.837 48.137V36.425c0-6.275-3.35-9.195-7.816-9.195-3.604.0-5.219 1.983-6.119 3.374V27.71h-6.79c.09 1.917.0 20.427.0 20.427h6.79V36.729c0-.609.044-1.219.224-1.655.49-1.22 1.607-2.483 3.482-2.483 2.458.0 3.44 1.873 3.44 4.618v10.929H50.837zM22.959 24.922c2.367.0 3.842-1.57 3.842-3.531-.044-2.003-1.475-3.528-3.797-3.528s-3.841 1.524-3.841 3.528c0 1.961 1.474 3.531 3.753 3.531H22.959zM34 64C17.432 64 4 50.568 4 34 4 17.431 17.432 4 34 4s30 13.431 30 30c0 16.568-13.432 30-30 30zM26.354 48.137V27.71h-6.789v20.427h6.789z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg></span><span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg></span></a><a href=https://stackoverflow.com/users/1251127/esg target=_blank class="stackoverflow ananke-social-link link-transition stackoverflow link dib z-999 pt3 pt0-l mr1" title="Stack Overflow link" rel=noopener aria-label="follow on Stack Overflow——Opens in a new window"><span class=icon><svg style="enable-background:new 0 0 67 67" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 0C5.373.0.0 5.373.0 12s5.373 12 12 12 12-5.373 12-12S18.627.0 12 0zm.869 5.903 3.114 4.567-.975.665-3.115-4.567.976-.665zm-2.812 2.585 4.84 2.838-.6 1.017-4.842-2.838.602-1.017zm-1.276 2.724 5.413 1.521-.291 1.077-5.428-1.458.306-1.14zm-.588 2.461 5.687.569-.103 1.12-5.691-.513.107-1.176zm-.169 2.16h5.835V17H8.024v-1.167zM16 19H6v-6h1v5h8v-5h1v6zm.195-8.602-.945-5.446 1.162-.202.947 5.446-1.164.202z"/></svg></span><span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg></span></a></div></div></div></nav></div></header><main class=pb7 role=main><article class="flex-l flex-wrap justify-between mw8 center ph3"><header class="mt4 w-100"><aside class="instapaper_ignoref b helvetica tracked">POSTS</aside><div id=sharing class="mt3 ananke-socials"><a href="https://twitter.com/share?url=https://esg.dev/posts/serilog-dos-and-donts/&text=Serilog%20Do%27s%20and%20Don%27ts" class="ananke-social-link twitter no-underline" aria-label="share on Twitter"><span class=icon><svg style="enable-background:new 0 0 67 67" viewBox="0 0 67 67" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M37.167 22.283c-2.619.953-4.274 3.411-4.086 6.101l.063 1.038-1.048-.127c-3.813-.487-7.145-2.139-9.974-4.915l-1.383-1.377-.356 1.017c-.754 2.267-.272 4.661 1.299 6.271.838.89.649 1.017-.796.487-.503-.169-.943-.296-.985-.233-.146.149.356 2.076.754 2.839.545 1.06 1.655 2.097 2.871 2.712l1.027.487-1.215.021c-1.173.0-1.215.021-1.089.467.419 1.377 2.074 2.839 3.918 3.475l1.299.444-1.131.678c-1.676.976-3.646 1.526-5.616 1.568C19.775 43.256 19 43.341 19 43.405c0 .211 2.557 1.397 4.044 1.864 4.463 1.377 9.765.783 13.746-1.568 2.829-1.673 5.657-5 6.978-8.221.713-1.716 1.425-4.851 1.425-6.354.0-.975.063-1.102 1.236-2.267.692-.678 1.341-1.419 1.467-1.631.21-.403.188-.403-.88-.043-1.781.636-2.033.551-1.152-.402.649-.678 1.425-1.907 1.425-2.267.0-.063-.314.042-.671.233-.377.212-1.215.53-1.844.72l-1.131.361-1.027-.7c-.566-.381-1.361-.805-1.781-.932C39.766 21.902 38.131 21.944 37.167 22.283zM33 64C16.432 64 3 50.569 3 34S16.432 4 33 4s30 13.431 30 30S49.568 64 33 64z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg></span></a><a href="https://www.linkedin.com/shareArticle?mini=true&url=https://esg.dev/posts/serilog-dos-and-donts/&title=Serilog%20Do%27s%20and%20Don%27ts" class="ananke-social-link linkedin no-underline" aria-label="share on LinkedIn"><span class=icon><svg style="enable-background:new 0 0 65 65" viewBox="0 0 65 65" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M50.837 48.137V36.425c0-6.275-3.35-9.195-7.816-9.195-3.604.0-5.219 1.983-6.119 3.374V27.71h-6.79c.09 1.917.0 20.427.0 20.427h6.79V36.729c0-.609.044-1.219.224-1.655.49-1.22 1.607-2.483 3.482-2.483 2.458.0 3.44 1.873 3.44 4.618v10.929H50.837zM22.959 24.922c2.367.0 3.842-1.57 3.842-3.531-.044-2.003-1.475-3.528-3.797-3.528s-3.841 1.524-3.841 3.528c0 1.961 1.474 3.531 3.753 3.531H22.959zM34 64C17.432 64 4 50.568 4 34 4 17.431 17.432 4 34 4s30 13.431 30 30c0 16.568-13.432 30-30 30zM26.354 48.137V27.71h-6.789v20.427h6.789z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg></span></a></div><h1 class="f1 athelas mt3 mb1">Serilog Do's and Don'ts</h1><time class="f6 mv4 dib tracked" datetime=2020-07-12T18:08:20-04:00>July 12, 2020</time></header><div class="nested-copy-line-height lh-copy serif f4 nested-links mid-gray pr4-l w-two-thirds-l"><p><a href=https://serilog.net/>Serilog</a> is a structured logger for <a href=https://dotnet.microsoft.com/>.NET</a>, and as such, for folks who are used to traditional console loggers, requires the developer to think about their logs a little more than normal.</p><p>This post is not meant to be a how to, but rather a non-comprehensive list of mistakes I&rsquo;ve seen over time.</p><h2 id=templating>Templating</h2><p>One thing to keep in mind is that when writing an event to the log, you are not passing a message, but a <em>template</em>. The tags you pass within curly branches do have meaning, and will be used to add data the event. It is therefore important to not format the message before passing logging it.</p><p>Consider a logger with a basic console sink</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cs data-lang=cs><span style=display:flex><span><span style=color:#66d9ef>var</span> textLogger = Log.Logger = <span style=color:#66d9ef>new</span> LoggerConfiguration()
</span></span><span style=display:flex><span>    .WriteTo.Console()
</span></span><span style=display:flex><span>    .CreateLogger();
</span></span></code></pre></div><p>With two very basic statements</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cs data-lang=cs><span style=display:flex><span>textLogger.Information(<span style=color:#e6db74>$&#34;Hello {world}&#34;</span>);
</span></span><span style=display:flex><span>textLogger.Information(<span style=color:#e6db74>&#34;Hello {value}&#34;</span>, world);
</span></span></code></pre></div><p>Will output:</p><pre tabindex=0><code>[18:19:18 INF] Hello World
[18:19:18 INF] Hello World
</code></pre><p>Can you spot the difference? Spoiler: There isn&rsquo;t one! So what&rsquo;s the problem then?</p><p>Well, let&rsquo;s use the <a href=https://github.com/serilog/serilog-formatting-compact>JSON Formatter</a> instead:</p><p>(note: I&rsquo;m using the <a href=https://github.com/serilog/serilog-formatting-compact#rendered-events>Rendered</a> formatter so we can see the rendered template within each event)</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cs data-lang=cs><span style=display:flex><span><span style=color:#66d9ef>var</span> jsonLogger = Log.Logger = <span style=color:#66d9ef>new</span> LoggerConfiguration()
</span></span><span style=display:flex><span>    .WriteTo.Console(<span style=color:#66d9ef>new</span> RenderedCompactJsonFormatter())
</span></span><span style=display:flex><span>    .CreateLogger();
</span></span></code></pre></div><p>With the same statements</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cs data-lang=cs><span style=display:flex><span>jsonLogger.Information(<span style=color:#e6db74>$&#34;Hello {world}&#34;</span>);
</span></span><span style=display:flex><span>jsonLogger.Information(<span style=color:#e6db74>&#34;Hello {value}&#34;</span>, world);
</span></span></code></pre></div><p>Will give us:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>	<span style=color:#f92672>&#34;@t&#34;</span>: <span style=color:#e6db74>&#34;2020-07-12T22:26:19.6616913Z&#34;</span>,
</span></span><span style=display:flex><span>	<span style=color:#f92672>&#34;@m&#34;</span>: <span style=color:#e6db74>&#34;Hello World&#34;</span>,
</span></span><span style=display:flex><span>	<span style=color:#f92672>&#34;@i&#34;</span>: <span style=color:#e6db74>&#34;00ba5a14&#34;</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>	<span style=color:#f92672>&#34;@t&#34;</span>: <span style=color:#e6db74>&#34;2020-07-12T22:26:19.6659300Z&#34;</span>,
</span></span><span style=display:flex><span>	<span style=color:#f92672>&#34;@m&#34;</span>: <span style=color:#e6db74>&#34;Hello \&#34;World\&#34;&#34;</span>,
</span></span><span style=display:flex><span>	<span style=color:#f92672>&#34;@i&#34;</span>: <span style=color:#e6db74>&#34;40c34e37&#34;</span>,
</span></span><span style=display:flex><span>	<span style=color:#f92672>&#34;value&#34;</span>: <span style=color:#e6db74>&#34;World&#34;</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>When using <code>textLogger.Information("Hello {value}", world)</code>, there is now a field called <code>value</code> with the argument we passed to the logging statements.
In addition, the <code>@i</code> field will have the same value every time this statement will run, so you have a fixed item to search for if you want to search for every value being logged by this particular statement.</p><h3 id=tldr>TLDR</h3><p><strong>DON&rsquo;T</strong> format messages before passing them to the logger</p><h2 id=destructuring>Destructuring</h2><p>One of the benefit of having a structured logger versus a flat one, is, well, <em>structure</em>. You are not limited to logging simple values, you can include entire object graphs. This process is called <em>Destructuring</em>.</p><p>Let&rsquo;s consider the following classes</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cs data-lang=cs><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>TestInnerClass</span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>string</span> SomeOtherProperty { <span style=color:#66d9ef>get</span>; <span style=color:#66d9ef>set</span>; }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>TestClass</span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>string</span> SomeProperty { <span style=color:#66d9ef>get</span>; <span style=color:#66d9ef>set</span>; }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> TestInnerClass SomeInnerClass { <span style=color:#66d9ef>get</span>; <span style=color:#66d9ef>set</span>; }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Let&rsquo;s initialize an instance</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cs data-lang=cs><span style=display:flex><span><span style=color:#66d9ef>var</span> obj = <span style=color:#66d9ef>new</span> TestClass
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    SomeInnerClass = <span style=color:#66d9ef>new</span> TestInnerClass
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        SomeOtherProperty = <span style=color:#e6db74>&#34;I am a property within a child&#34;</span>
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>    SomeProperty = <span style=color:#e6db74>&#34;I am a property at the root level&#34;</span>
</span></span><span style=display:flex><span>};
</span></span></code></pre></div><p>And let&rsquo;s include it a logging statement</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cs data-lang=cs><span style=display:flex><span>jsonLogger.Information(<span style=color:#e6db74>&#34;Useful log for object {object}&#34;</span>, obj);
</span></span></code></pre></div><p>This will output</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>	<span style=color:#f92672>&#34;@t&#34;</span>: <span style=color:#e6db74>&#34;2020-07-12T22:43:28.1191964Z&#34;</span>,
</span></span><span style=display:flex><span>	<span style=color:#f92672>&#34;@m&#34;</span>: <span style=color:#e6db74>&#34;Useful log for object \&#34;SerilogTest.TestClass\&#34;&#34;</span>,
</span></span><span style=display:flex><span>	<span style=color:#f92672>&#34;@i&#34;</span>: <span style=color:#e6db74>&#34;146d94ee&#34;</span>,
</span></span><span style=display:flex><span>	<span style=color:#f92672>&#34;object&#34;</span>: <span style=color:#e6db74>&#34;SerilogTest.TestClass&#34;</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>What? <code>SerilogTest.TestClass</code>? By default, Serilog will simply call <code>ToString</code> on your object. To destructure it, simply add <code>a</code> before the field in your template</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cs data-lang=cs><span style=display:flex><span>jsonLogger.Information(<span style=color:#e6db74>&#34;Useful log for object {@object}&#34;</span>, obj);
</span></span></code></pre></div><p>And the output will be</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>	<span style=color:#f92672>&#34;@t&#34;</span>: <span style=color:#e6db74>&#34;2020-07-12T22:43:28.1525906Z&#34;</span>,
</span></span><span style=display:flex><span>	<span style=color:#f92672>&#34;@m&#34;</span>: <span style=color:#e6db74>&#34;Useful log for object TestClass { SomeProperty: \&#34;I am a property at the root level\&#34;, SomeInnerClass: TestInnerClass { SomeOtherProperty: \&#34;I am a property within a child\&#34; } }&#34;</span>,
</span></span><span style=display:flex><span>	<span style=color:#f92672>&#34;@i&#34;</span>: <span style=color:#e6db74>&#34;99aea052&#34;</span>,
</span></span><span style=display:flex><span>	<span style=color:#f92672>&#34;object&#34;</span>: {
</span></span><span style=display:flex><span>		<span style=color:#f92672>&#34;SomeProperty&#34;</span>: <span style=color:#e6db74>&#34;I am a property at the root level&#34;</span>,
</span></span><span style=display:flex><span>		<span style=color:#f92672>&#34;SomeInnerClass&#34;</span>: {
</span></span><span style=display:flex><span>			<span style=color:#f92672>&#34;SomeOtherProperty&#34;</span>: <span style=color:#e6db74>&#34;I am a property within a child&#34;</span>,
</span></span><span style=display:flex><span>			<span style=color:#f92672>&#34;$type&#34;</span>: <span style=color:#e6db74>&#34;TestInnerClass&#34;</span>
</span></span><span style=display:flex><span>		},
</span></span><span style=display:flex><span>		<span style=color:#f92672>&#34;$type&#34;</span>: <span style=color:#e6db74>&#34;TestClass&#34;</span>
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>As you can see, the entire object graph was included within the event. So much contextual information!</p><p>But what if there are properties that you do not want to log? After all, it&rsquo;s typically frowned upon to include information like passwords or personally identifiable information within them.</p><p>Let&rsquo;s reconfigure the logger to only log <code>SomeProperty</code>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cs data-lang=cs><span style=display:flex><span><span style=color:#66d9ef>var</span> jsonLogger = Log.Logger = <span style=color:#66d9ef>new</span> LoggerConfiguration()
</span></span><span style=display:flex><span>    .WriteTo.Console(<span style=color:#66d9ef>new</span> RenderedCompactJsonFormatter())
</span></span><span style=display:flex><span>    .Destructure.ByTransforming&lt;TestClass&gt;(c =&gt; <span style=color:#66d9ef>new</span> { c.SomeProperty })
</span></span><span style=display:flex><span>    .CreateLogger();
</span></span></code></pre></div><p>Will give us</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>	<span style=color:#f92672>&#34;@t&#34;</span>: <span style=color:#e6db74>&#34;2020-07-12T22:49:44.7386801Z&#34;</span>,
</span></span><span style=display:flex><span>	<span style=color:#f92672>&#34;@m&#34;</span>: <span style=color:#e6db74>&#34;Useful log for object { SomeProperty: \&#34;I am a property at the root level\&#34; }&#34;</span>,
</span></span><span style=display:flex><span>	<span style=color:#f92672>&#34;@i&#34;</span>: <span style=color:#e6db74>&#34;99aea052&#34;</span>,
</span></span><span style=display:flex><span>	<span style=color:#f92672>&#34;object&#34;</span>: {
</span></span><span style=display:flex><span>		<span style=color:#f92672>&#34;SomeProperty&#34;</span>: <span style=color:#e6db74>&#34;I am a property at the root level&#34;</span>
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>We only included the property we wanted!</p><p>Note that there are different ways to configure destructuring. A good start in the (awesomely named) <a href=https://github.com/destructurama>Destructurama!</a> organization.</p><h3 id=type-conflicts>Type conflicts</h3><p>Just a side note about destructing objects regarding conflicting types. Some log aggregating services will use the parameter names within templates to define types.</p><p>An example of this is Elasticsearch.</p><p>With the following statement</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cs data-lang=cs><span style=display:flex><span>jsonLogger.Information(<span style=color:#e6db74>&#34;Hello {value}&#34;</span>, <span style=color:#e6db74>&#34;world&#34;</span>);
</span></span><span style=display:flex><span>jsonLogger.Information(<span style=color:#e6db74>&#34;Hello {value}&#34;</span>, <span style=color:#66d9ef>new</span> { <span style=color:#66d9ef>value</span> = <span style=color:#e6db74>&#34;world&#34;</span> });
</span></span></code></pre></div><p>Since the first statement will generate a string field called &ldquo;value&rdquo; in the mapping, the second statement will not be logged, as Elasticsearch will complain about trying to fit an object within a string field.</p><h3 id=tldr-1>TLDR</h3><p><strong>DO</strong> include object graph when they add contextual information to your statements
<strong>AVOID</strong> including unnecessary objects. They can clutter your logs, and if you&rsquo;re pushing them to external services that charges by the size of logs you send them, it will quite literally cost you.
<strong>DO</strong> Be mindful of conflicts that can happen with your parameter names</p><h2 id=exceptions>Exceptions</h2><p>The one thing to remember is that Serilog&rsquo;s methods all have an overload that accepts an <code>Exception</code> as the first parameter.</p><p>So instead of writing statements including the exception as part of the message template</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cs data-lang=cs><span style=display:flex><span><span style=color:#66d9ef>var</span> exception = <span style=color:#66d9ef>new</span> Exception(<span style=color:#e6db74>&#34;Top exception&#34;</span>, <span style=color:#66d9ef>new</span> Exception(<span style=color:#e6db74>&#34;Inner exception&#34;</span>));
</span></span><span style=display:flex><span>jsonLogger.Information(<span style=color:#e6db74>&#34;Exception! {exception}&#34;</span>, exception);
</span></span></code></pre></div><p>Which will include the exception within the <code>exception</code> parameter</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>	<span style=color:#f92672>&#34;@t&#34;</span>: <span style=color:#e6db74>&#34;2020-07-12T23:01:14.1165769Z&#34;</span>,
</span></span><span style=display:flex><span>	<span style=color:#f92672>&#34;@m&#34;</span>: <span style=color:#e6db74>&#34;Exception! \&#34;System.Exception: Top exception\r\n ---&gt; System.Exception: Inner exception\r\n   --- End of inner exception stack trace ---\&#34;&#34;</span>,
</span></span><span style=display:flex><span>	<span style=color:#f92672>&#34;@i&#34;</span>: <span style=color:#e6db74>&#34;e22b2a9a&#34;</span>,
</span></span><span style=display:flex><span>	<span style=color:#f92672>&#34;exception&#34;</span>: <span style=color:#e6db74>&#34;System.Exception: Top exception\r\n ---&gt; System.Exception: Inner exception\r\n   --- End of inner exception stack trace ---&#34;</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Simply include the exception as the first argument</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cs data-lang=cs><span style=display:flex><span><span style=color:#66d9ef>var</span> exception = <span style=color:#66d9ef>new</span> Exception(<span style=color:#e6db74>&#34;Top exception&#34;</span>, <span style=color:#66d9ef>new</span> Exception(<span style=color:#e6db74>&#34;Inner exception&#34;</span>));
</span></span><span style=display:flex><span>jsonLogger.Information(exception, <span style=color:#e6db74>&#34;Exception&#34;</span>);
</span></span></code></pre></div><p>And now all logged exceptions will be within the <code>@x</code> field.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>	<span style=color:#f92672>&#34;@t&#34;</span>: <span style=color:#e6db74>&#34;2020-07-12T23:01:14.1532597Z&#34;</span>,
</span></span><span style=display:flex><span>	<span style=color:#f92672>&#34;@m&#34;</span>: <span style=color:#e6db74>&#34;Exception&#34;</span>,
</span></span><span style=display:flex><span>	<span style=color:#f92672>&#34;@i&#34;</span>: <span style=color:#e6db74>&#34;7d53da39&#34;</span>,
</span></span><span style=display:flex><span>	<span style=color:#f92672>&#34;@x&#34;</span>: <span style=color:#e6db74>&#34;System.Exception: Top exception\r\n ---&gt; System.Exception: Inner exception\r\n   --- End of inner exception stack trace ---&#34;</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Note that this behaviour can change depending on your sink. For example, the <a href=https://github.com/serilog/serilog-sinks-elasticsearch>Elasticsearch sink</a> will include the exceptions within an object array.</p><h3 id=tldr-2>TLDR</h3><p><strong>DO</strong> use Serilog&rsquo;s overloads to pass exceptions instead of using the argument list.</p><h2 id=conclusion>Conclusion</h2><p>Those were just a few basic things to keep in mind when using Serilog. I stringly suggest visiting the <a href=https://github.com/serilog/serilog/wiki/Writing-Log-Events>Writing log events</a> page for more information.</p><ul class=pa0><li class="list di"><a href=/tags/serilog class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif">Serilog</a></li><li class="list di"><a href=/tags/.net class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif">.NET</a></li></ul><div class="mt6 instapaper_ignoref"></div></div><aside class="w-30-l mt6-l"><div class="bg-light-gray pa3 nested-list-reset nested-copy-line-height nested-links"><p class="f5 b mb3">Related</p><ul class="pa0 list"><li class=mb2><a href=/posts/httpclient-with-system-text-json/>Using HttpClient with System.Text.Json</a></li></ul></div></aside></article></main><footer class="bg-black bottom-0 w-100 pa3" role=contentinfo><div class="flex justify-between"><a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href=https://esg.dev/>&copy; ESG's 2022</a><div><div class=ananke-socials><a href=https://twitter.com/Eric_STG target=_blank class="twitter ananke-social-link link-transition stackoverflow link dib z-999 pt3 pt0-l mr1" title="Twitter link" rel=noopener aria-label="follow on Twitter——Opens in a new window"><span class=icon><svg style="enable-background:new 0 0 67 67" viewBox="0 0 67 67" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M37.167 22.283c-2.619.953-4.274 3.411-4.086 6.101l.063 1.038-1.048-.127c-3.813-.487-7.145-2.139-9.974-4.915l-1.383-1.377-.356 1.017c-.754 2.267-.272 4.661 1.299 6.271.838.89.649 1.017-.796.487-.503-.169-.943-.296-.985-.233-.146.149.356 2.076.754 2.839.545 1.06 1.655 2.097 2.871 2.712l1.027.487-1.215.021c-1.173.0-1.215.021-1.089.467.419 1.377 2.074 2.839 3.918 3.475l1.299.444-1.131.678c-1.676.976-3.646 1.526-5.616 1.568C19.775 43.256 19 43.341 19 43.405c0 .211 2.557 1.397 4.044 1.864 4.463 1.377 9.765.783 13.746-1.568 2.829-1.673 5.657-5 6.978-8.221.713-1.716 1.425-4.851 1.425-6.354.0-.975.063-1.102 1.236-2.267.692-.678 1.341-1.419 1.467-1.631.21-.403.188-.403-.88-.043-1.781.636-2.033.551-1.152-.402.649-.678 1.425-1.907 1.425-2.267.0-.063-.314.042-.671.233-.377.212-1.215.53-1.844.72l-1.131.361-1.027-.7c-.566-.381-1.361-.805-1.781-.932C39.766 21.902 38.131 21.944 37.167 22.283zM33 64C16.432 64 3 50.569 3 34S16.432 4 33 4s30 13.431 30 30S49.568 64 33 64z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg></span><span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg></span></a><a href=https://github.com/EricStG target=_blank class="github ananke-social-link link-transition stackoverflow link dib z-999 pt3 pt0-l mr1" title="GitHub link" rel=noopener aria-label="follow on GitHub——Opens in a new window"><span class=icon><svg style="enable-background:new 0 0 512 512" viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M256 32C132.3 32 32 134.8 32 261.7c0 101.5 64.2 187.5 153.2 217.9 11.2 2.1 15.3-5 15.3-11.1.0-5.5-.2-19.9-.3-39.1-62.3 13.9-75.5-30.8-75.5-30.8-10.2-26.5-24.9-33.6-24.9-33.6-20.3-14.3 1.5-14 1.5-14 22.5 1.6 34.3 23.7 34.3 23.7 20 35.1 52.4 25 65.2 19.1 2-14.8 7.8-25 14.2-30.7-49.7-5.8-102-25.5-102-113.5.0-25.1 8.7-45.6 23-61.6-2.3-5.8-10-29.2 2.2-60.8.0.0 18.8-6.2 61.6 23.5 17.9-5.1 37-7.6 56.1-7.7 19 .1 38.2 2.6 56.1 7.7 42.8-29.7 61.5-23.5 61.5-23.5 12.2 31.6 4.5 55 2.2 60.8 14.3 16.1 23 36.6 23 61.6.0 88.2-52.4 107.6-102.3 113.3 8 7.1 15.2 21.1 15.2 42.5.0 30.7-.3 55.5-.3 63 0 6.1 4 13.3 15.4 11C415.9 449.1 480 363.1 480 261.7 480 134.8 379.7 32 256 32z"/></svg></span><span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg></span></a><a href=https://www.linkedin.com/in/eric-st-georges/ target=_blank class="linkedin ananke-social-link link-transition stackoverflow link dib z-999 pt3 pt0-l mr1" title="LinkedIn link" rel=noopener aria-label="follow on LinkedIn——Opens in a new window"><span class=icon><svg style="enable-background:new 0 0 65 65" viewBox="0 0 65 65" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M50.837 48.137V36.425c0-6.275-3.35-9.195-7.816-9.195-3.604.0-5.219 1.983-6.119 3.374V27.71h-6.79c.09 1.917.0 20.427.0 20.427h6.79V36.729c0-.609.044-1.219.224-1.655.49-1.22 1.607-2.483 3.482-2.483 2.458.0 3.44 1.873 3.44 4.618v10.929H50.837zM22.959 24.922c2.367.0 3.842-1.57 3.842-3.531-.044-2.003-1.475-3.528-3.797-3.528s-3.841 1.524-3.841 3.528c0 1.961 1.474 3.531 3.753 3.531H22.959zM34 64C17.432 64 4 50.568 4 34 4 17.431 17.432 4 34 4s30 13.431 30 30c0 16.568-13.432 30-30 30zM26.354 48.137V27.71h-6.789v20.427h6.789z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg></span><span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg></span></a><a href=https://stackoverflow.com/users/1251127/esg target=_blank class="stackoverflow ananke-social-link link-transition stackoverflow link dib z-999 pt3 pt0-l mr1" title="Stack Overflow link" rel=noopener aria-label="follow on Stack Overflow——Opens in a new window"><span class=icon><svg style="enable-background:new 0 0 67 67" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 0C5.373.0.0 5.373.0 12s5.373 12 12 12 12-5.373 12-12S18.627.0 12 0zm.869 5.903 3.114 4.567-.975.665-3.115-4.567.976-.665zm-2.812 2.585 4.84 2.838-.6 1.017-4.842-2.838.602-1.017zm-1.276 2.724 5.413 1.521-.291 1.077-5.428-1.458.306-1.14zm-.588 2.461 5.687.569-.103 1.12-5.691-.513.107-1.176zm-.169 2.16h5.835V17H8.024v-1.167zM16 19H6v-6h1v5h8v-5h1v6zm.195-8.602-.945-5.446 1.162-.202.947 5.446-1.164.202z"/></svg></span><span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg></span></a></div></div></div></footer></body></html>